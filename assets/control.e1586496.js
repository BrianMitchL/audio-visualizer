import"./index.1dd16ad5.js";import{r as o,u as h,j as n,a as m,v as g,b as w,E as v,c as y,B as x}from"./index.d2323753.js";function z({deviceId:c}){const[i,r]=o.exports.useState(null),e=h("audio"),[t,l]=o.exports.useState(null);return o.exports.useEffect(()=>{async function a(){const s=await navigator.mediaDevices.getUserMedia({audio:{deviceId:c},video:!1}),d=s.getAudioTracks()[0];d!=null&&d.label&&l({name:d.label});const u=new window.AudioContext,f=new window.AnalyserNode(u,{minDecibels:-90,maxDecibels:-10,smoothingTimeConstant:.85});f.fftSize=32,u.createMediaStreamSource(s).connect(f,0),r(f)}return a(),()=>{r(null),l(null)}},[c]),o.exports.useEffect(()=>{if(!i)return;const a=i.frequencyBinCount,s=setInterval(()=>{if(!e.current)return;const d=new Uint8Array(a);i.getByteFrequencyData(d),e.current.postMessage(d)},5);return()=>{clearInterval(s)}},[i,e]),n("div",{children:t?m("p",{children:["Playing from audio source ",n("code",{children:t.name}),"."]}):null})}function b(){const[c,i]=o.exports.useState([]),[r,e]=o.exports.useState(null);return o.exports.useEffect(()=>{async function t(){const l=await navigator.mediaDevices.enumerateDevices();i(l.filter(a=>a.kind==="audioinput"))}t()},[]),o.exports.useEffect(()=>{async function t(){const l=await navigator.mediaDevices.getUserMedia({audio:!0});e(l.id)}r||t()},[r]),m("div",{children:[n("h2",{children:"Audio Input Devices"}),n("p",{children:"Select an input device. If device names aren't showing up, please allow microphone/audio access in your browser, and mark it to remember your decision or always allow, and then reload the page."}),n("ul",{children:c.map(t=>n("li",{children:n("button",{onClick:()=>e(t.deviceId),"aria-pressed":t.deviceId===r,children:t.label||`Unknown device ${t.deviceId}`.trim()})},t.deviceId))}),r?n(z,{deviceId:r}):null]})}const I={"visualizer-form":"_visualizer-form_732rw_1"};function C({id:c}){const i=h("control"),r=o.exports.useId();return m("section",{children:[m("h2",{children:["Visualizer - ",c]}),m("form",{className:I["visualizer-form"],onSubmit:e=>{e.preventDefault();const t=new FormData(e.currentTarget).get("visualizer");if(typeof t=="string"&&i.current){const l={name:"set-visualizer",data:{viewId:c,visualizerFileName:t}};i.current.postMessage(l)}},children:[n("label",{htmlFor:r,children:"Visualizer"}),n("select",{id:r,name:"visualizer",required:!0,children:g.map(e=>n("option",{value:e.id,children:e.display},e.id))}),n("button",{type:"submit",children:"Set Visualizer"})]})]})}const A="_alert_1xg19_1",p={alert:A,"new-visualizer-window":"_new-visualizer-window_1xg19_8"};function D(){const c=h("control");w("control");const[i,r]=o.exports.useState([]);return o.exports.useEffect(()=>{const e=c.current;if(!e)return;const t=l=>{r(a=>{const s=l.data;switch(s.name){case"register":return a.concat([s.data]);case"unregister":return a.filter(d=>d.id!==s.data.id);case"ping":return a.find(u=>u.id===s.data.id)?a.map(u=>u.id===s.data.id?s.data:u):a.concat([s.data]);default:return a}})};return e.addEventListener("message",t),()=>{e.removeEventListener("message",t)}},[c]),m("div",{children:[i.filter(e=>e.type==="control").length>1?m("p",{role:"alert",className:p.alert,children:[n("strong",{children:"Warning"}),", using more than one control at a time is not supported.",null]}):null,n("a",{href:"../visualizer/",target:"_blank",rel:"noreferrer noopener",className:p["new-visualizer-window"],children:"Open New Visualizer"}),n(v,{children:n(b,{})}),i.filter(e=>e.type==="visualizer").map(e=>n(C,{id:e.id},e.id))]})}y(document.getElementById("root")).render(n(o.exports.StrictMode,{children:n(x,{children:n(v,{children:n(D,{})})})}));
